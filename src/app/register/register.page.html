<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="end">
      <ion-button color='primary' (click)="goToLogin()">Regresar</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-avatar class="avatar"> 
    <img src="../../assets/imagenes/usuario.png" alt="logo" class="logo">
  </ion-avatar>

  <form [formGroup]="registerForm" (ngSubmit)="register(registerForm.value)">
    <ion-item>
      <ion-input 
        label="Nombre" 
        formControlName="name" 
       labelPlacement="floating" 
        placeholder="Nombre"
      ></ion-input>
    </ion-item>
    <div class="validaciones">
      <ng-container *ngFor="let validation of validation_messages.name">
        <div *ngIf="
          (registerForm.get('name')?.hasError(validation.type) && 
          registerForm.get('name')?.dirty)
          ">
          <ion-icon name="close-circle-outline" size="medium"></ion-icon>
        {{validation.message}}</div>
      </ng-container>
    </div>
      <ion-item>
        <ion-input 
          label="Apellido" 
          formControlName="last_name" 
          labelPlacement="floating" 
          placeholder="Apellido"
        ></ion-input>
      </ion-item>
      <div class="validaciones">
        <ng-container *ngFor="let validation of validation_messages.last_name">
          <div *ngIf="
            (registerForm.get('last_name')?.hasError(validation.type) && 
            registerForm.get('last_name')?.dirty)
            ">
            <ion-icon name="close-circle-outline" size="medium"></ion-icon>
          {{validation.message}}</div>
        </ng-container>
      </div>
    <ion-item>
      <ion-input 
        label="Email" 
        formControlName="email" 
        type="email" 
        labelPlacement="floating" 
        placeholder="Email"
      ></ion-input>
    </ion-item>
    <div class="validaciones">
      <ng-container *ngFor="let validation of validation_messages.email">
        <div *ngIf="
          (registerForm.get('email')?.hasError(validation.type) && 
          registerForm.get('email')?.dirty)
          ">
          <ion-icon name="close-circle-outline" size="medium"></ion-icon>
          {{validation.message}}</div>
      </ng-container>
    </div>
    <ion-item>
      <ion-input id="password"
        label="Contraseña" 
        formControlName="password" 
        type="password" 
        placeholder="Contraseña" 
        labelPlacement="floating"
        [counter]="true"
        maxlength="10"
      >
    </ion-input>
    </ion-item>
    <div class="validaciones">
      <ng-container *ngFor="let validation of validation_messages.password">
        <div *ngIf="
          (registerForm.get('password')?.hasError(validation.type) && 
          registerForm.get('password')?.dirty) 
          ">
          <ion-icon name="close-circle-outline" size="medium"></ion-icon>
          {{validation.message}}
        </div>
      </ng-container>
    </div>
    <ion-item>
      <ion-input id="confirmaPassword"
       label="Confirmar Contraseña" 
        formControlName="confirmaPassword" 
        type="password" 
        placeholder="Contraseña" 
        labelPlacement="floating"
        [counter]="true"
        maxlength="10"
        >
      </ion-input>
    </ion-item>
      <div class="validaciones">
        <ng-container *ngFor="let validation of validation_messages.confirmaPassword">
         <div *ngIf="
            (registerForm.get('confirmaPassword')?.hasError(validation.type) && 
            registerForm.get('confirmaPassword')?.dirty) 
         ">
            <ion-icon name="close-circle-outline" size="medium"></ion-icon>
            {{validation.message}}</div>
        </ng-container>
      </div>
      <div class="validaciones">
         <div *ngIf="registerForm.get('password')?.value != '' && (registerForm.get('password')?.value != registerForm.get('confirmaPassword')?.value)">
            <ion-icon name="close-circle-outline" size="medium"></ion-icon>
             Las contraseñas no coinciden.
         </div>
      </div>
    <div>
      <div class="button-crear">
        <ion-button id="btnCrea" type="submit" [disabled]="!registerForm.valid" shape="round" color="success" expand="full" >Crear</ion-button>
      </div>   
    </div>
  </form>
</ion-content>